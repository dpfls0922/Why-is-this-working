## 9.1 연관관계 매핑 종류와 방향

RDBMS를 사용할 때는 테이블 하나만 사용해서 애플리케이션의 모든 기능을 구현하기란 불가능하다. 대체로 설계가 복잡하면 각 `도메인에 맞는 테이블을 설계`하고, `연관관계를 설정`해서 `조인(Join)` 등의 기능을 활용한다.

JPA를 사용하는 애플리케이션에서도 테이블의 연관관계를 `엔티티 간의 연관관계`로 표현할 수 있다.

- 다만, 객체와 테이블의 성질이 달라 정확한 연관관계 표현은 힘듦

이번 장에서는 JPA에서 이러한 제약을 보완하면서 연관관계를 매핑하고 사용하는 방법을 알아본다.

**연관관계를 맺는 두 엔티티 간에 생성할 수 있는 연관관계의 종류**

- `One to One` : 일대일 (1:1)
- `One to Many` : 일대다 (1:N)
- `Many to One` : 다대일 (N:1)
- `Many to Many` : 다대다 (N:M)

**연관 관계 이해를 위한 예시**

한 가게가 재고관리 시스템을 통해 상품을 관리한다고 가정한다. 재고로 등록돼 있는 `상품 엔티티`에는 가게로 상품을 공급하는 `공급업체의 정보 엔티티가 매핑`되어 있다.

`공긍 업체 입장`에서 보면 한 가게에 납품하는 상품이 여러 개 있을 수 있음므로 상품 엔티티와는 `일대다` 관계가 되며, `상품 입장`에서 보면 하나의 공급 업체에 속하게 되므로 `다대일` 관계가 된다.

- 즉, 어떤 엔티티를 중심으로 연관 엔티티를 보느냐에 따라 연관 상태가 달라짐

<img src="https://velog.velcdn.com/images/dnrwhddk1/post/1bba11d3-4d27-4d7c-b8b8-7ad3c0501e06/image.png" weight=300 height=200/>

DB에서는 두 테이블의 연관관계를 설정하면 `외래키를 통해 서로 조인해서 참조하는 구조로 생성`되지만, `JPA를 사용하는 객체지향 모델링`에서는 엔티티 간 `참조 방향을 설정`할 수 있다. DB와 관계를 일치시키기 위해 양방향으로 설정하는 것도 괜찮지만, `비즈니스 로직 관점`에서는 `단방향` 관계만 설정해도 해결되는 경우 많다.

- `단방향` : 두 엔티티 관계에서 한쪽의 엔티티만 참조하는 형식
- `양방향` : 두 엔티티 관계에서 각 엔티티가 서로의 엔티티를 참조하는 형식

연관관계가 설정되면 한 테이블에서는 `다른 테이블의 기본값을 외래키`로 가지게 된다. 이런 관계에서는 주인(Owner)라는 개념이 사용된다. 일반적으로 외래키를 가진 테이블이 그 관계의 `Owner`가 되며, 주인은 외래키를 사용할 수 있으나 `상대 엔티티는 읽는 작업만 수행`할 수 있다.