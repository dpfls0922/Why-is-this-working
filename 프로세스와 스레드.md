# 프로세스와 스레드


# 1. 프로세스와 스레드?

### 프로세스

![](https://velog.velcdn.com/images%2Fasroq1%2Fpost%2F2fc92368-9c83-4c00-8eb5-82dc9e345baf%2F%E1%84%91%E1%85%B3%E1%84%85%E1%85%A9%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3.png)

> OS로부터 자원을 할당받은 작업의 단위
> 

우리가 windonw의 .exe나 mac의 .dmg 확장자를 **프로그램**이라고 부른다.

프로그램의 특징은 아래와 같다.

- 메모리에 올라가 있지 않다.
- 정적이다. 즉 실행되지 않고 가만히 있다.

이제 우리가 위와 같은 특징을 가진 .exe(프로그램)을 클릭해서 실행한다면 실행하는 순간 파일은 컴퓨터 메모리에 올라가고 **동적**인 상태가 된다.

이 상태의 프로그램을 **프로세스**라고 한다.

> 즉 프로그램은 코드 파일이고, 그 코드 파일을 실행한 결과가 프로세스이다.
> 

## 스레드

![](https://velog.velcdn.com/images%2Fasroq1%2Fpost%2F5a2ddd2d-d4c1-4405-a724-a2e76d98229d%2F%E1%84%8A%E1%85%B3%E1%84%85%E1%85%A6%E1%84%83%E1%85%B3.png)

> 프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위
> 

예전에는 프로그램의 실행을 한 개의 프로세스만 사용했다고 한다. 그런데 요즘에는 유튜브를 보면서 롤도 함께 해야하는 세상이다.

이런 문제를 해결하기 위해 개발자들은 이런 생각을 했다. '한 프로그램을 처리하기 위한 프로세스를 여러 개 만들면 안될까?' 그러나 이것은 불가능했다.

이유는 운영체제는 안정성을 위해 프로세스마다 할당된 메모리 내의 정보에만 접근할 수 있도록 제약을 걸었다. 이를 벗어나는 정보에 접근하면 에러가 발생한다.

이렇게 프로세스를 다중으로 만들 수는 없어 만들어낸 것이 프로세스보다 더 작은 실행 단위 개념인 **스레드**이다.

**스레드의 특징은?**

스레드는 프로세스와 다르게 스레드 간 메모리를 공유하며 작동한다. 스레드끼리 프로세스의 자원을 공유하며 프로세스 실행 흐름의 일부가 된다.

> 스레드는 프로세스의 코드에 정의된 절차에 따라 실행되는 특정한 수행 경로이다
> 

<br>
<br>

# 2. ****프로세스와 스레드의 작동 방식****

## 프로세스의 작동 방식

위에서 프로세스가 메모리에 올라갈 때 운영체제로부터 시스템 자원을 할당받는다. 이때 운영체제는 프로세스마다 각각 독립된 메모리 영역을, Code/Data/Stack/Heap의 형식으로 할당해 준다. 각각 독립된 메모리 영역을 할당해 주기 때문에 프로세스는 다른 프로세스의 변수나 자료에 접근할 수 없다.

![image](https://github.com/dpfls0922/Why-is-this-working/assets/83818069/e3ccc17c-5a49-4a94-95d0-b0724754d51a)

![image](https://github.com/dpfls0922/Why-is-this-working/assets/83818069/5248d99a-ec6c-4818-b126-c73f83cdceac)


## 스레드의 작동 방식

이와 다르게 스레드는 메모리를 서로 공유할 수 있다. 이에 대해 더 자세히 설명하자면, 프로세스가 할당받은 메모리 영역 내에서 Stack 형식으로 할당된 메모리 영역은 따로 할당받고, 나머지 Code/Data/Heap 형식으로 할당된 메모리 영역을 공유한다. 따라서 각각의 스레드는 별도의 스택을 가지고 있지만 힙 메모리는 서로 읽고 쓸 수 있게 된다.

![](https://velog.velcdn.com/images%2Fraejoonee%2Fpost%2Fb91490ed-c67b-407d-8fea-a8d6fdb22559%2F104.png)

**여기서 프로세스와 스레드의 중요한 차이를 하나 더 알 수 있게 된다.** 만약 한 프로세스를 실행하다가 오류가 발생해서 프로세스가 강제로 종료된다면, 다른 프로세스에게 어떤 영향이 있을까? 공유하고 있는 파일을 손상시키는 경우가 아니라면 아무런 영향을 주지 않는다.

그런데 스레드의 경우는 다르다. 스레드는 Code/Data/Heap 메모리 영역의 내용을 공유하기 때문에 어떤 스레드 하나에서 오류가 발생한다면 같은 프로세스 내의 다른 스레드 모두가 강제로 종료된다.

본문에서 언급했듯 스레드를 코드(프로세스) 내에서의 함수(스레드)에 빗대어 표현해보면 이해하기 훨씬 쉬워진다. 코딩을 해 본 경험이 있다면, 코드 내 어떤 함수 하나에서 **Segmentation Fault** 등의 오류가 발생한 경험이 있을 것이다. 이 오류가 어떤 함수에서 발생했든 간에 해당 코드는 다른 함수 모두에 대한 작업을 중단하고 프로세스 실행을 끝내버린다.
